(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[     15540,        417]
NotebookOptionsPosition[     13779,        386]
NotebookOutlinePosition[     14201,        403]
CellTagsIndexPosition[     14158,        400]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Parameters", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"baseWord", "=", "\"\<asd\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{"testList", "=", 
     RowBox[{"{", 
      RowBox[{"\"\<rio\>\"", ",", "\"\<river\>\"", ",", "\"\<rio\>\"", 
       ",", "\"\<rau\>\"", ",", "\"\<fiume\>\"", ",", "\"\<riviere\>\""}], 
      "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"padChar", "=", "\"\<_\>\""}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Function", " ", "to", " ", "pad", " ", "two", " ", "strings", " ", "to", 
     " ", "the", " ", "same", " ", "length"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{
     RowBox[{"padToSameLength", "[", 
      RowBox[{"str1_", ",", "str2_", ",", "padChar_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"len1", ",", "len2", ",", "maxlen"}], "}"}], ",", 
       RowBox[{
        RowBox[{"len1", "=", 
         RowBox[{"StringLength", "[", "str1", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"len2", "=", 
         RowBox[{"StringLength", "[", "str2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"maxlen", "=", 
         RowBox[{"Max", "[", 
          RowBox[{"len1", ",", "len2"}], "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"StringPadRight", "[", 
           RowBox[{"str1", ",", "maxlen", ",", "padChar"}], "]"}], ",", 
          RowBox[{"StringPadRight", "[", 
           RowBox[{"str2", ",", "maxlen", ",", "padChar"}], "]"}]}], 
         "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Loss", " ", 
     RowBox[{"function", ":", 
      RowBox[{"Hamming", " ", "distance", " ", "after", " ", "padding"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"lossFunction", "[", 
      RowBox[{"word1_", ",", "word2_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"w1", ",", "w2"}], "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"w1", ",", "w2"}], "}"}], "=", 
         RowBox[{"padToSameLength", "[", 
          RowBox[{"word1", ",", "word2", ",", "padChar"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Characters", "[", "w1", "]"}], "!=", 
            RowBox[{"Characters", "[", "w2", "]"}]}], "]"}], ",", "True"}], 
         "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Mutation", ":", 
     RowBox[{
     "change", " ", "one", " ", "character", " ", "to", " ", "match", " ", 
      "target"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"mutateWord", "[", 
      RowBox[{"base_", ",", "target_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"b", ",", "t", ",", "diffs", ",", "idx", ",", "newBase"}], 
        "}"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"b", ",", "t"}], "}"}], "=", 
         RowBox[{"padToSameLength", "[", 
          RowBox[{"base", ",", "target", ",", "padChar"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"diffs", "=", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{
             RowBox[{"Characters", "[", "b", "]"}], "!=", 
             RowBox[{"Characters", "[", "t", "]"}]}], "]"}], ",", "True"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"diffs", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"Return", "[", "base", "]"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{"no", " ", "mutation", " ", "needed"}], "*)"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{"RandomChoice", "[", "diffs", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newBase", "=", 
         RowBox[{"Characters", "[", "b", "]"}]}], ";", "\[IndentingNewLine]", 
        
        RowBox[{
         RowBox[{"newBase", "[", 
          RowBox[{"[", "idx", "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"Characters", "[", "t", "]"}], "[", 
          RowBox[{"[", "idx", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"StringJoin", "[", "newBase", "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Evolution", " ", 
     RowBox[{"loop", ":", 
      RowBox[{"single", " ", "generation"}]}]}], "*)"}], "\[IndentingNewLine]",
    GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"evolveOnce", "[", 
         RowBox[{"base_", ",", "testList_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"losses", ",", "mostDifferent", ",", "newBase"}], "}"}], ",", 
          RowBox[{
           RowBox[{"losses", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"lossFunction", "[", 
               RowBox[{"base", ",", "#"}], "]"}], "&"}], "/@", "testList"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"mostDifferent", "=", 
            RowBox[{"testList", "[", 
             RowBox[{"[", 
              RowBox[{"First", "@", 
               RowBox[{"Ordering", "[", 
                RowBox[{"losses", ",", 
                 RowBox[{"-", "1"}]}], "]"}]}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"newBase", "=", 
            RowBox[{"mutateWord", "[", 
             RowBox[{"base", ",", "mostDifferent"}], "]"}]}], ";", 
           "\[IndentingNewLine]", "newBase"}]}], "]"}]}], ";"}]},
     {"\[Placeholder]"}
    }], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Run", " ", "evolution", " ", "for", " ", "N", " ", "generations"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"runEvolution", "[", 
      RowBox[{"initial_", ",", "list_", ",", "gens_"}], "]"}], ":=", 
     RowBox[{"NestList", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"evolveOnce", "[", 
         RowBox[{"#", ",", "list"}], "]"}], "&"}], ",", "initial", ",", 
       "gens"}], "]"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Example", " ", "run"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"runEvolution", "[", 
    RowBox[{"baseWord", ",", "testList", ",", "10"}], "]"}], 
   "\n"}]}]], "Input",
 CellChangeTimes->{{3.960643697762808*^9, 3.9606437062117043`*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"07998cb6-6da4-4d34-b0d8-f6c707369dc6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "Null", "}"}], ",", 
   RowBox[{"{", "\[Placeholder]", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.960643711117648*^9},
 CellLabel->
  "Out[316]=",ExpressionUUID->"77a57af9-a8c0-4980-a026-d5f0ebfa03bd"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 318, 48, 26406546293539325147, "Local"},
  
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711138563*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"28754137-651c-4805-a525-cec7109bfffb"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
cannot be used as a part specification.\"", 2, 318, 49, 26406546293539325147, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711164432*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"e39dbc27-cf42-40f5-b892-6305e06732b8"],

Cell[BoxData[
 TemplateBox[{
  "Set", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
cannot be used as a part specification.\"", 2, 318, 50, 26406546293539325147, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711182263*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"0582e740-62f8-4e76-bceb-cee2f75ca33d"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 318, 51, 26406546293539325147, "Local"},
  
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711190209*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"46f4ecd6-2bea-4ca2-b809-0576d8d21d16"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
cannot be used as a part specification.\"", 2, 318, 52, 26406546293539325147, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711196281*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"148a4892-3828-4601-9fb4-068ef196aa88"],

Cell[BoxData[
 TemplateBox[{
  "Set", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
cannot be used as a part specification.\"", 2, 318, 53, 26406546293539325147, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711202868*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"31c72308-3919-4f77-a6e1-aceb41a870cc"],

Cell[BoxData[
 TemplateBox[{
  "Part", "partw", 
   "\"Part \\!\\(\\*RowBox[{\\\"1\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
\\\"}\\\"}]\\) does not exist.\"", 2, 318, 54, 26406546293539325147, "Local"},
  
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711210291*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"b82e03df-bd20-418f-a7b7-76115660239c"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 318, 55, 26406546293539325147, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711217484*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"e2773b92-2c1c-4af0-9cba-f3110e1e77af"],

Cell[BoxData[
 TemplateBox[{
  "Part", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
cannot be used as a part specification.\"", 2, 318, 56, 26406546293539325147, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711224092*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"0f6a5775-3f4c-47e8-806b-176e2ec673ac"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 318, 57, 26406546293539325147, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711229678*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"e9eafacf-7ea7-49c2-b296-eac2a8d8f084"],

Cell[BoxData[
 TemplateBox[{
  "Set", "pkspec1", 
   "\"The expression \\!\\(\\*RowBox[{RowBox[{\\\"{\\\", \\\"}\\\"}], \\\"\
\[LeftDoubleBracket]\\\", \\\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) \
cannot be used as a part specification.\"", 2, 318, 58, 26406546293539325147, 
   "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711235281*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"ba2e0899-bc21-4f35-bc49-1ffaf7560c94"],

Cell[BoxData[
 TemplateBox[{
  "General", "stop", 
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Set\\\", \\\"::\\\", \\\
\"pkspec1\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"", 2, 318, 59, 26406546293539325147, "Local"},
  "MessageTemplate",
  BaseStyle->"MSG"]], "Message",
 CellChangeTimes->{3.960643711243886*^9},
 CellLabel->
  "During evaluation of \
In[310]:=",ExpressionUUID->"9e8e9b33-9ad2-44a0-a88c-e4fbc4254494"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"asd\"\>", ",", "\<\"asd____\"\>", ",", "\<\"asd____\"\>", 
   ",", "\<\"asd____\"\>", ",", "\<\"asd____\"\>", ",", "\<\"asd____\"\>", 
   ",", "\<\"asd____\"\>", ",", "\<\"asd____\"\>", ",", "\<\"asd____\"\>", 
   ",", "\<\"asd____\"\>", ",", "\<\"asd____\"\>"}], "}"}]], "Output",
 CellChangeTimes->{3.960643711250483*^9},
 CellLabel->
  "Out[318]=",ExpressionUUID->"cefe1fad-caf4-4456-bd1d-c32c8d181105"]
}, Open  ]]
},
WindowSize->{1080, 625.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.9 Inherited,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"5348a866-cfd7-4cf7-b480-78df6bb64ffc"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[576, 22, 6850, 180, 708, "Input",ExpressionUUID->"07998cb6-6da4-4d34-b0d8-f6c707369dc6"],
Cell[7429, 204, 262, 7, 30, "Output",ExpressionUUID->"77a57af9-a8c0-4980-a026-d5f0ebfa03bd"],
Cell[7694, 213, 408, 11, 23, "Message",ExpressionUUID->"28754137-651c-4805-a525-cec7109bfffb"],
Cell[8105, 226, 494, 12, 23, "Message",ExpressionUUID->"e39dbc27-cf42-40f5-b892-6305e06732b8"],
Cell[8602, 240, 493, 12, 23, "Message",ExpressionUUID->"0582e740-62f8-4e76-bceb-cee2f75ca33d"],
Cell[9098, 254, 408, 11, 23, "Message",ExpressionUUID->"46f4ecd6-2bea-4ca2-b809-0576d8d21d16"],
Cell[9509, 267, 494, 12, 23, "Message",ExpressionUUID->"148a4892-3828-4601-9fb4-068ef196aa88"],
Cell[10006, 281, 493, 12, 23, "Message",ExpressionUUID->"31c72308-3919-4f77-a6e1-aceb41a870cc"],
Cell[10502, 295, 408, 11, 23, "Message",ExpressionUUID->"b82e03df-bd20-418f-a7b7-76115660239c"],
Cell[10913, 308, 465, 11, 23, "Message",ExpressionUUID->"e2773b92-2c1c-4af0-9cba-f3110e1e77af"],
Cell[11381, 321, 494, 12, 23, "Message",ExpressionUUID->"0f6a5775-3f4c-47e8-806b-176e2ec673ac"],
Cell[11878, 335, 467, 11, 23, "Message",ExpressionUUID->"e9eafacf-7ea7-49c2-b296-eac2a8d8f084"],
Cell[12348, 348, 493, 12, 23, "Message",ExpressionUUID->"ba2e0899-bc21-4f35-bc49-1ffaf7560c94"],
Cell[12844, 362, 466, 11, 23, "Message",ExpressionUUID->"9e8e9b33-9ad2-44a0-a88c-e4fbc4254494"],
Cell[13313, 375, 450, 8, 30, "Output",ExpressionUUID->"cefe1fad-caf4-4456-bd1d-c32c8d181105"]
}, Open  ]]
}
]
*)

