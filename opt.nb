(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Wolfram 14.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       154,          7]
NotebookDataLength[      7444,        211]
NotebookOptionsPosition[      6658,        190]
NotebookOutlinePosition[      7080,        207]
CellTagsIndexPosition[      7037,        204]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"baseWord", "=", "\"\<asd\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"testList", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<rio\>\"", ",", "\"\<river\>\"", ",", "\"\<rio\>\"", 
     ",", "\"\<rau\>\"", ",", "\"\<fiume\>\"", ",", "\"\<riviere\>\""}], 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"padChar", "=", "\"\<_\>\""}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"pad", "[", 
    RowBox[{"w1_", ",", "w2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "maxLen", "}"}], ",", 
     RowBox[{
      RowBox[{"maxLen", "=", 
       RowBox[{"Max", "[", 
        RowBox[{
         RowBox[{"StringLength", "[", "w1", "]"}], ",", 
         RowBox[{"StringLength", "[", "w2", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"StringPadRight", "[", 
         RowBox[{"w1", ",", "maxLen", ",", "padChar"}], "]"}], ",", 
        RowBox[{"StringPadRight", "[", 
         RowBox[{"w2", ",", "maxLen", ",", "padChar"}], "]"}]}], "}"}]}]}], 
    "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wordDifference", "[", 
    RowBox[{"w1_", ",", "w2_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pw1", ",", "pw2"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pw1", ",", "pw2"}], "}"}], "=", 
       RowBox[{"pad", "[", 
        RowBox[{"w1", ",", "w2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Total", "[", 
       RowBox[{"MapThread", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"#1", "!=", "#2"}], ",", "1", ",", "0"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Characters", "[", "pw1", "]"}], ",", 
           RowBox[{"Characters", "[", "pw2", "]"}]}], "}"}]}], "]"}], 
       "]"}]}]}], "]"}]}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mostDifferentWord", "[", 
    RowBox[{"base_", ",", "testList_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "diffs", "}"}], ",", 
     RowBox[{
      RowBox[{"diffs", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"word", ",", 
           RowBox[{"wordDifference", "[", 
            RowBox[{"base", ",", "word"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"word", ",", "testList"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"First", "@", 
       RowBox[{"MaximalBy", "[", 
        RowBox[{"diffs", ",", "Last"}], "]"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evolveToward", "[", 
   RowBox[{"base_", ",", "target_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"targetPadded", ",", "diffIndices", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"targetPadded", "=", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"StringLength", "[", "target", "]"}], "<", 
         RowBox[{"StringLength", "[", "base", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StringPadRight", "[", 
         RowBox[{"target", ",", 
          RowBox[{"StringLength", "[", "base", "]"}], ",", "padChar"}], "]"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"StringTake", "[", 
         RowBox[{"target", ",", 
          RowBox[{"StringLength", "[", "base", "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "targetPadded", "]"}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"diffIndices", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Position", "[", 
        RowBox[{
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "!=", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Characters", "[", "base", "]"}], ",", 
             RowBox[{"Characters", "[", "targetPadded", "]"}]}], "}"}]}], 
          "]"}], ",", "True"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"diffIndices", "===", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Return", "[", "base", "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"i", "=", 
      RowBox[{"RandomChoice", "[", "diffIndices", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"StringReplacePart", "[", 
      RowBox[{"base", ",", 
       RowBox[{"StringTake", "[", 
        RowBox[{"targetPadded", ",", 
         RowBox[{"{", "i", "}"}]}], "]"}], ",", "i"}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.960634681743196*^9, 3.960634683504665*^9}, {
   3.960634744823072*^9, 3.960634818214446*^9}, {3.960634872196672*^9, 
   3.960634894635963*^9}, 3.960635110116584*^9},
 CellLabel->
  "In[188]:=",ExpressionUUID->"24ae5ee2-0235-4a6a-9f71-2f1a514aac29"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"evolveToward", "[", 
  RowBox[{"\"\<asd\>\"", ",", " ", "\"\<test\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.9606347459336233`*^9, 3.960634750008964*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"f6ced096-24da-4349-b3ad-fe08ad22a20d"],

Cell[BoxData["\<\"tes\"\>"], "Print",
 CellChangeTimes->{{3.960634819016098*^9, 3.9606348238095922`*^9}, 
   3.960634876777483*^9},
 CellLabel->
  "During evaluation of \
In[195]:=",ExpressionUUID->"34ddac57-f697-4b2f-abcf-e89d547783c6"],

Cell[BoxData["\<\"tsd\"\>"], "Output",
 CellChangeTimes->{{3.9606347502191467`*^9, 3.9606347534063883`*^9}, {
   3.960634819028507*^9, 3.960634823821393*^9}, 3.9606348767858067`*^9},
 CellLabel->
  "Out[195]=",ExpressionUUID->"ccbbd577-a78b-45f9-9e36-4cb8ae129e43"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.960634739391116*^9, 
  3.9606347401621113`*^9}},ExpressionUUID->"9930ca26-ff99-494e-9f6f-\
4232da5e0e3c"]
},
WindowSize->{1080, 625.5},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>0.8 Inherited,
FrontEndVersion->"14.2 for Linux x86 (64-bit) (March 16, 2025)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"d000432e-430e-4d84-b329-f153edf4be12"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[554, 20, 5133, 140, 419, "Input",ExpressionUUID->"24ae5ee2-0235-4a6a-9f71-2f1a514aac29"],
Cell[CellGroupData[{
Cell[5712, 164, 265, 5, 25, "Input",ExpressionUUID->"f6ced096-24da-4349-b3ad-fe08ad22a20d"],
Cell[5980, 171, 237, 5, 18, "Print",ExpressionUUID->"34ddac57-f697-4b2f-abcf-e89d547783c6"],
Cell[6220, 178, 265, 4, 38, "Output",ExpressionUUID->"ccbbd577-a78b-45f9-9e36-4cb8ae129e43"]
}, Open  ]],
Cell[6500, 185, 154, 3, 23, "Input",ExpressionUUID->"9930ca26-ff99-494e-9f6f-4232da5e0e3c"]
}
]
*)

